function bitStreamer(a,b,c,d,e){this.x=a,this.y=b,this.lastX=this.x,this.lastY=this.y,this.orientation=c,this.velocity=d,this.lifeTime=e,this.currentTime=0,this.isActive=!0,this.update=function(a){this.lastX=this.x,this.lastY=this.y,this.x+=this.velocity*Math.cos(toRad(this.orientation))*a,this.y+=this.velocity*Math.sin(toRad(this.orientation))*a},this.draw=function(){this.isActive&&draw.drawText(this.x,this.y,"0"),draw.drawText(this.lastX,this.lastY,"1")}}function bullet(a,b,c,d,e,f,g){this.x=a,this.y=b,this.orientation=c,this.velocity=d,this.elevation=f,this.lifeTime=e,this.currentTime=0,this.safe=g,this.isActive=!0,this.update=function(a){if(this.x+=this.velocity*Math.cos(toRad(this.orientation))*a,this.y+=this.velocity*Math.sin(toRad(this.orientation))*a,this.isActive){for(var b=0;b<game.currentSector.enemyManager.enemies.length;b++)this.isActive&&pointInRectangle(this,game.currentSector.enemyManager.enemies[b])&&(game.currentSector.enemyManager.enemies[b].onHit(10),this.isActive=!1);for(var b=0;b<game.currentSector.pillars.length;b++)pointInRectangle(this,game.currentSector.pillars[b])&&(0==this.elevation?this.isActive=!1:1==this.elevation&&1==game.currentSector.pillars[b].elevation&&(this.isActive=!1));for(var b=0;b<game.players.length;b++)this.safe||pointInRectangle(this,game.players[b])&&(0==this.elevation?0==game.players[b].getElevation()&&(console.log("HIT"),this.isActive=!1,game.players[b].onHit(10)):1==this.elevation&&(console.log("HIT"),this.isActive=!1,game.players[b].onHit(10)));this.currentTime+=a,this.currentTime>this.lifeTime&&(this.isActive=!1)}},this.draw=function(){this.isActive&&(this.elevation<game.players[0].getElevation()?draw.drawText(this.x,this.y,"0","#008800"):draw.drawText(this.x,this.y,"0","#00FF00"))}}function bulletManager(){this.bullets=[],this.addBullet=function(a){this.bullets.push(a)},this.update=function(a){for(var b=0;b<this.bullets.length;b++){var c=this.bullets[b];c.update(a),0==c.isActive&&(this.bullets.splice(b,1),b--)}},this.draw=function(){for(var a=0;a<this.bullets.length;a++)this.bullets[a].draw()}}function controlsMenu(){this.stockControls={Common:{SWITCH:75,CAMERA:67},Ship:{ACCEL:87,DECEL:83,TURNRIGHT:68,TURNLEFT:65,SHOOT:73,SPECIAL:16},Bot:{ACCEL:87,DECEL:83,TURNLEFT:65,TURNRIGHT:68,STRAFELEFT:74,STRAFERIGHT:76,SHOOT:73,SPECIAL:16}},this.reverseControls={Common:{SWITCH:75,CAMERA:67},Ship:{ACCEL:83,DECEL:87,TURNRIGHT:68,TURNLEFT:65,SHOOT:73,SPECIAL:16},Bot:{ACCEL:87,DECEL:83,TURNLEFT:65,TURNRIGHT:68,STRAFELEFT:74,STRAFERIGHT:76,SHOOT:73,SPECIAL:16}},this.customControls={Common:{SWITCH:75,CAMERA:67},Ship:{ACCEL:83,DECEL:87,TURNRIGHT:68,TURNLEFT:65,SHOOT:73,SPECIAL:16},Bot:{ACCEL:87,DECEL:83,TURNLEFT:65,TURNRIGHT:68,STRAFELEFT:74,STRAFERIGHT:76,SHOOT:73,SPECIAL:16}},this.controlsTimer=.5,this.currentControlsTimer=this.controlsTimer,this.controlsChoice=0,this.controlTypes=["REGULAR","REVERSE","CUSTOM1"],this.update=function(a){this.currentControlsTimer-=a,this.currentControlsTimer<0&&game.keys[39]&&(this.controlsChoice++,this.controlsChoice%=this.controlTypes.length,"REGULAR"==this.controlsChoice?game.KeyBinds=this.stockControls:"REVERSE"==this.controlsChoice?game.KeyBinds=this.reverseControls:"CUSTOM1"==this.controlsChoice?game.KeyBinds=this.customControls:game.KeyBinds=this.stockControls,this.currentControlsTimer=this.controlsTimer)},this.draw=function(a){draw.drawControlsMenu()}}function coordinate(a,b){this.x=a,this.y=b,this.width=1,this.height=3,this.right=function(){return this.x+this.width/2},this.left=function(){return this.x-this.width/2},this.top=function(){return this.y-this.height/2},this.bottom=function(){return this.y+this.height/2},this.draw=function(){draw.drawText(this.x,this.y,this.x+","+this.y)},this.update=function(){}}function drawCameraCentricObject(a,b){this.cameraX=a,this.cameraY=b,this.drawGame=function(){var a=document.getElementById("gameCanvas"),b=a.getContext("2d");draw.drawBackgroundRect(game.gameWidth/2,game.gameHeight/2,game.gameWidth,game.gameHeight,game.colors.Background),this.drawGrid();for(var c=0;c<game.currentSector.pillars.length;c++)game.currentSector.pillars[c].draw();game.currentSector.bulletManager.draw(),game.currentSector.enemyManager.draw();for(var d=0;d<game.coordinates.length;d++)game.coordinates[d].draw();for(var c=0;c<game.players.length;c++)game.players[c].draw();b.stroke(),b.closePath(),b.beginPath(),b.fillStyle="#000000",b.rect(0,a.height-gameYToCanvasY(20),a.width,a.height),b.stroke(),b.fill(),draw.drawInfoText(10,15,"Life: "+game.players[0].currentLife),b.closePath()},this.drawControlsMenu=function(){var a=document.getElementById("gameCanvas"),b=a.getContext("2d");console.log("controls"),b.clearRect(0,0,a.width,a.height),draw.drawBackgroundRect(game.gameWidth/2,game.gameHeight/2,game.gameWidth,game.gameHeight,game.colors.Background),draw.drawInfoText(10,game.gameHeight-10,game.controlsMenu.controlTypes[game.controlsMenu.controlsChoice]);var c=1;draw.drawInfoText(15,game.gameHeight-10-5*c,"Common"),c++;for(var d in game.KeyBinds.Common)draw.drawInfoText(20,game.gameHeight-10-5*c,d),c++;draw.drawInfoText(15,game.gameHeight-10-5*c,"Ship"),c++;for(var d in game.KeyBinds.Ship)draw.drawInfoText(20,game.gameHeight-10-5*c,d),c++;draw.drawInfoText(15,game.gameHeight-10-5*c,"Bot"),c++;for(var d in game.KeyBinds.Bot)draw.drawInfoText(20,game.gameHeight-10-5*c,d),c++},this.drawEquipmentMenu=function(){var a=document.getElementById("gameCanvas"),b=a.getContext("2d");console.log("controls"),b.clearRect(0,0,a.width,a.height),draw.drawBackgroundRect(game.gameWidth/2,game.gameHeight/2,game.gameWidth,game.gameHeight,game.colors.Background);for(var c=0;c<game.pillars.length;c++)game.pillars[0].draw()},this.drawGrid=function(){var a=game.ctx;a.beginPath(),a.strokeStyle="#00FF00",a.fillStyle="#00FF00";for(var b=-10;b<11;b++)a.beginPath(),a.moveTo(gameXToCanvasX(-200+game.gameWidth/2-this.cameraX),gameYToCanvasY(20*b+game.gameHeight/2+this.cameraY)),a.lineTo(gameXToCanvasX(200+game.gameWidth/2-this.cameraX),gameYToCanvasY(20*b+game.gameHeight/2+this.cameraY)),a.stroke(),a.beginPath(),a.moveTo(gameXToCanvasX(20*b+game.gameWidth/2-this.cameraX),gameYToCanvasY(-200+game.gameHeight/2+this.cameraY)),a.lineTo(gameXToCanvasX(20*b+game.gameWidth/2-this.cameraX),gameYToCanvasY(200+game.gameHeight/2+this.cameraY)),a.stroke()},this.drawRect=function(a,b,c,d){var f=(document.getElementById("gameCanvas"),game.ctx);f.rect(gameXToCanvasX(a),gameYToCanvasY(b),gameXToCanvasX(c),gameYToCanvasY(d)),f.stroke()},this.drawPlayerRect=function(a,b,c,d,e){var g=(document.getElementById("gameCanvas"),game.ctx),h=game.players[0];g.save(),g.translate(gameXToCanvasX(game.players[0].x+game.gameWidth/2-this.cameraX),gameYToCanvasY(-game.players[0].y+game.gameHeight/2+this.cameraY)),g.rotate(toRad(-e+90)),g.beginPath(),"ship"==h.state&&(g.beginPath(),g.moveTo(gameXToCanvasX(0),gameYToCanvasY(-2)),g.lineTo(gameXToCanvasX(-.5),gameYToCanvasY(2)),g.lineTo(gameXToCanvasX(.5),gameYToCanvasY(2)),g.fill(),g.closePath(),g.beginPath(),g.moveTo(gameXToCanvasX(0),gameYToCanvasY(-1)),g.lineTo(gameXToCanvasX(-1),gameYToCanvasY(1)),g.lineTo(gameXToCanvasX(1),gameYToCanvasY(1)),g.fill(),g.closePath()),"bot"==h.state&&(g.rect(gameXToCanvasX(-h.width/2-h.width),gameYToCanvasY(-h.height/2),gameXToCanvasX(c/2),gameYToCanvasY(d)),g.rect(gameXToCanvasX(h.width),gameYToCanvasY(-h.height/2),gameXToCanvasX(c/2),gameYToCanvasY(d)),g.rect(gameXToCanvasX(-h.height/2),gameYToCanvasY(h.height/8),gameXToCanvasX(h.height),gameYToCanvasY(h.width/2)),g.fill()),g.closePath(),g.restore(),g.stroke()},this.drawRectCentered=function(a,b,c,d,e,f){var g=document.getElementById("gameCanvas"),h=g.getContext("2d");h.save(),h.beginPath(),h.fillStyle=e,h.rect(gameXToCanvasX(a-c/2+game.gameWidth/2-this.cameraX),gameYToCanvasY(-b-d/2+game.gameHeight/2+this.cameraY),gameXToCanvasX(c),gameYToCanvasY(d)),h.stroke(),f&&h.fill(),h.closePath(),h.restore()},this.drawRect=function(a,b,c,d,e,f){var g=document.getElementById("gameCanvas"),h=g.getContext("2d");h.save(),h.beginPath(),h.rect(gameXToCanvasX(a+game.gameWidth/2-this.cameraX),gameYToCanvasY(-b+game.gameHeight/2+this.cameraY),gameXToCanvasX(c),gameYToCanvasY(d)),h.stroke(),f&&h.fill(),h.closePath(),h.restore()},this.drawBackgroundRect=function(a,b,c,d,e){var f=document.getElementById("gameCanvas"),g=f.getContext("2d");g.save(),g.beginPath(),g.fillStyle="#000000",g.rect(gameXToCanvasX(a-c/2),gameYToCanvasY(b-d/2),gameXToCanvasX(c),gameYToCanvasY(d)),g.stroke(),g.fill(),g.closePath(),g.restore()},this.drawCircle=function(a,b,c,d){var e=game.ctx;e.beginPath(),e.save(),e.strokeStyle=d,e.lineWidth=2,e.arc(gameXToCanvasX(a),gameYToCanvasY(b),gameXToCanvasX(c),0,2*Math.PI,!1),e.stroke(),e.restore()},this.drawFilledCircle=function(a,b,c,d){var e=game.ctx;e.save(),e.beginPath(),e.fillStyle=d,e.arc(gameXToCanvasX(a),gameYToCanvasY(b),gameXToCanvasX(c),0,2*Math.PI,!1),e.fill(),e.stroke(),e.restore()},this.drawText=function(a,b,c,d){var e=game.ctx;e.save(),e.beginPath(),e.fillStyle="#00FF00",void 0!=d&&(e.fillStyle=d),e.fillText(c,gameXToCanvasX(a+game.gameWidth/2-this.cameraX),gameYToCanvasY(-b+game.gameHeight/2+this.cameraY)),e.stroke(),e.restore()},this.drawInfoText=function(a,b,c){var d=game.ctx;d.save(),d.beginPath(),d.fillStyle="#00FF00",d.fillText(c,gameXToCanvasX(a),gameYToCanvasY(game.gameHeight-b)),d.stroke(),d.restore()}}function toRad(a){return a*Math.PI/180}function toDeg(a){return a/Math.PI*180}function enemyManager(a,b){this.enemies=[],this.addEnemy=function(a){this.enemies.push(a)},this.update=function(a){for(var b=0;b<this.enemies.length;b++){var c=this.enemies[b];"DEAD"==c.state&&(this.enemies.splice(b,1),b--),c.update(a)}},this.draw=function(){for(var a=0;a<this.enemies.length;a++)this.enemies[a].draw()}}function switchWeapon(a){game.selectedWeapon++,game.selectedWeapon%=2}function keyDown(a){game.keys[a.keyCode]=!0}function keyUp(a){game.keys[a.keyCode]=!1}function followBot(a,b,c){this.x=a,this.y=b,this.width=5,this.height=5,this.orientation=90,this.velocity=5,this.maxHealth=100,this.health=100,this.shotElevation=c,this.isHit=!1,this.movementState="RUN",this.state="",this.switchTime=5,this.currentSwitchTime=0,this.shotTime=1,this.currentShotTime=0,this.target=game.players[0],this.right=function(){return this.x+this.width/2},this.left=function(){return this.x-this.width/2},this.top=function(){return this.y+this.height/2},this.bottom=function(){return this.y-this.height/2},this.update=function(a){this.currentShotTime+=a,this.currentShotTime>this.shotTime&&(this.shoot(),this.currentShotTime=0),this.currentSwitchTime+=a,this.currentSwitchTime>this.switchTime&&(this.movementState="FOLLOW"),this.currentSwitchTime>2*this.switchTime&&(this.movementState="RUN",this.currentSwitchTime=0),"RUN"==this.movementState&&(this.x+=this.velocity*Math.cos(toRad(this.orientation))*a,this.y+=this.velocity*Math.sin(toRad(this.orientation))*a),"FOLLOW"==this.movementState&&(this.x-=this.velocity*Math.cos(toRad(this.orientation))*a,this.y-=this.velocity*Math.sin(toRad(this.orientation))*a)},this.onHit=function(a){this.health-=a,this.health<=0&&(this.state="DEAD")},this.shoot=function(){var a=this.target.y-this.y,b=this.target.x-this.x,c=a/b,d=toDeg(Math.atan(c));b<0&&(d+=180);var e=new bullet(this.x+15*Math.cos(toRad(d)),this.y+15*Math.sin(toRad(d)),d,30,1,this.shotElevation);game.currentSector.bulletManager.addBullet(e)},this.draw=function(){"DEAD"!=this.state&&(draw.drawRectCentered(this.x,this.y,this.width,this.height,"#FF0000"),draw.drawRect(this.x-this.width/2,this.y-.8*this.height,this.width,.5),draw.drawRect(this.x-this.width/2,this.y-.8*this.height,this.width*(this.health/this.maxHealth),.5,"#FF0000",!0))}}function gameObject(){this.gameWidth=200,this.gameHeight=3*this.gameWidth/4;var a={Background:"#000000",Ship:"#00FF00",Enemy:"#CEF5FB",Bomb:"#343A3B",Well:"#8AAAAF"},b={Common:{SWITCH:75,CAMERA:67},Ship:{ACCEL:87,DECEL:83,TURNRIGHT:68,TURNLEFT:65,SHOOT:73,SPECIAL:16},Bot:{ACCEL:87,DECEL:83,TURNLEFT:65,TURNRIGHT:68,STRAFELEFT:74,STRAFERIGHT:76,SHOOT:73,SPECIAL:16}};this.controlsMenu=new controlsMenu,this.KeyBinds=b,this.menuTimerMax=1,this.menuTimer=this.menuTimerMax,this.screen="GAME",this.colors=a,this.Canvas=document.getElementById("gameCanvas"),this.ctx=this.Canvas.getContext("2d"),this.isMobile=function(){return!!(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))},this.draw=function(){"MENU"==this.screen?(draw.drawControlsMenu(),this.controlsMenu.draw()):"GAME"==this.screen?draw.drawGame():"EQUIP"==this.screen&&draw.drawEquipmentMenu()},this.update=function(a){this.menuTimer-=a,game.keys[77]?this.menuTimer<0&&("MENU"==this.screen?(this.screen="GAME",console.log("toGame")):(this.screen="MENU",console.log("toMenu")),this.menuTimer=this.menuTimerMax):game.keys[78]&&this.menuTimer<0&&("EQUIP"==this.screen?this.screen="GAME":this.screen="EQUIP",this.menuTimer=this.menuTimerMax),"GAME"==this.screen?this.updateGame(a):"MENU"==this.screen?this.updateControlsMenu(a):"EQUIP"==this.screen&&this.updateEquipmentMenu(a)},this.updateEquipmentMenu=function(a){},this.updateControlsMenu=function(a){this.controlsMenu.update(a)},this.updateGame=function(a){for(var b=0;b<game.players.length;b++)game.players[b].update(a);this.currentSector.update(a)},this.gravity=0,this.level=0,this.score=0,this.clicks=[],this.keys=[],this.buttons=[],this.meters=[],this.players=[],this.boxes=[],this.coordinates=[],this.currentSector=new worldSector(0,0),this.streamers=[],this.drawType="player",this.meterTypes={Level:0},this.init=function(){this.players.push(new player(0,0));for(var a=0;a<200;a+=25)this.coordinates.push(new coordinate(-a,a)),this.coordinates.push(new coordinate(a,a)),this.coordinates.push(new coordinate(-a,-a)),this.coordinates.push(new coordinate(a,-a));this.currentSector.pillars.push(new pillar(70,40,5,100,0)),this.currentSector.pillars.push(new pillar(-70,40,5,100,0)),this.currentSector.pillars.push(new pillar(90,40,5,100,1)),this.currentSector.pillars.push(new pillar(-90,40,5,100,1)),this.currentSector.enemyManager.addEnemy(new followBot(this.players[0].x+30,this.players[0].y+60,1)),this.meters.push(new meter(this.gameWidth/2,this.gameHeight-17.5,this.meterTypes.Level)),this.lastTime=Date.now(),this.nowTime=this.lastTime},this.levelUp=function(){this.currentLevelTimer=0}}function playerFloorHit(a,b){var c=!1,d=!1;return(a.bottom()>b.top()&&a.bottom()<b.bottom()||a.top()<b.bottom()&&a.top()>b.top())&&(c=!0),(a.left()<b.right()&&a.left()>b.left()||a.right()>b.left()&&a.right()<b.right())&&(d=!0),c&&d}function pointInRectangle(a,b){return a.x>=b.left()&&a.x<=b.right()&&a.y>=b.bottom()&&a.y<=b.top()}function pointInRectangleX(a,b){return a.x>=b.left()&&a.x<=b.right()&&a.y>=b.bottom()&&a.y<=b.top()}function pointInRectangleY(a,b){return a.y>=b.bottom()&&a.y<=b.top()&&a.x>=b.left()&&a.x<=b.right()}function rectangleHitCircle(a,b){}function rectangleHitRectangle(a,a){a.printSides()}function circleHitCircle(a,a){}function mouseHitButton(a,b,c){var d=distance(a,b,c.x,c.y);return d<c.radius}function distance(a,b,c,d){return Math.sqrt((d-b)*(d-b)+(c-a)*(c-a))}function animLoop(){game.nowTime=Date.now();var a=(game.nowTime-game.lastTime)/1e3;game.update(a),game.draw(),requestAnimFrame(animLoop),game.lastTime=game.nowTime}function meter(a,b,c){this.x=a,this.y=b,this.type=c,this.orientations={Horizontal:0,Vertical:1},this.type==game.meterTypes.Level&&(this.width=40,this.height=2,this.currentLevel=game.currentLevelTimer,this.maxLevel=10,this.orientation=this.orientations.Horizontal),this.update=function(a){this.type==game.meterTypes.Level&&(this.currentLevel+=a,this.currentLevel>this.maxLevel&&(this.currentLevel=0))},this.draw=function(){if(this.type==game.meterTypes.Life)var a=game.colors.Ship;else var a="#000000";this.orientation==this.orientations.Vertical?(draw.drawRectCentered(this.x,this.y,this.width,this.height,"#000000"),draw.drawFilledRectCentered(this.x,this.y,this.width,this.height*(this.currentLevel/this.maxLevel),a)):this.orientation==this.orientations.Horizontal&&(draw.drawRectCentered(this.x,this.y,this.width,this.height,"#000000"),draw.drawFilledRectCentered(this.x,this.y,this.width*(1-this.currentLevel/this.maxLevel),this.height,a))}}function pillar(a,b,c,d,e){this.x=a,this.y=b,this.width=c,this.height=d,this.elevation=e,this.right=function(){return this.x+this.width/2},this.left=function(){return this.x-this.width/2},this.top=function(){return this.y+this.height/2},this.bottom=function(){return this.y-this.height/2},this.update=function(a){},this.draw=function(){1==this.elevation?("ship"==game.players[0].state&&draw.drawRectCentered(this.x,this.y,this.width,this.height,"#009900",!0),"bot"==game.players[0].state&&draw.drawRectCentered(this.x,this.y,this.width,this.height,"#00FF00",!0)):0==this.elevation&&("ship"==game.players[0].state&&draw.drawRectCentered(this.x,this.y,this.width,this.height,"#002200",!0),"bot"==game.players[0].state&&draw.drawRectCentered(this.x,this.y,this.width,this.height,"#00AA00",!0))}}function player(a,b){this.x=a,this.y=b,this.velX=0,this.velY=0,this.velStrafe=0,this.velocity=0,this.width=1,this.height=3,this.accel=20,this.moveSpeed=20,this.shotType="MACHINEGUN",this.maxLife=100,this.currentLife=100,this.lifeRegen=2,this.shotSpeed=20,this.swapCooldown=1,this.swapCooldownCurrent=0,this.cameraCooldown=.25,this.cameraCooldownCurrent=0,this.shotCooldown=.2,this.shotCooldownCurrent=0,this.orientation=90,this.heading=this.orientation,this.isAlive=!0,this.state="ship",this.getElevation=function(){return"ship"==this.state?this.highFlying?2:1:"bot"==this.state?0:void 0},this.onHit=function(a){this.currentLife-=a,console.log(this.currentLife)},this.right=function(){return this.x+this.width/2},this.left=function(){return this.x-this.width/2},this.top=function(){return this.y+this.height/2},this.bottom=function(){return this.y-this.height/2},this.printSides=function(){console.log("Player Right: "+this.right()+" Left: "+this.left()+" Top"+this.top()+" Bottom"+this.bottom())},this.draw=function(){this.isAlive&&draw.drawPlayerRect(game.gameWidth/2,game.gameHeight/2,this.width,this.height,this.orientation)},this.update=function(a){if(this.currentLife<=0)this.isAlive=!1,this.shoot("DEATH");else{this.swapCooldownCurrent-=a,this.cameraCooldownCurrent-=a,this.shotCooldownCurrent-=a,game.keys[game.KeyBinds.Common.SWITCH]&&this.swapCooldownCurrent<=0&&("bot"==this.state?(this.state="ship",this.shotType="MACHINEGUN"):"ship"==this.state&&(this.state="bot",this.shotType="SHOTGUN"),this.swapCooldownCurrent=this.swapCooldown),game.keys[game.KeyBinds.Common.CAMERA]&&this.cameraCooldownCurrent<=0&&("camera"==game.drawType?game.drawType="player":"player"==game.drawType&&(draw=new drawCameraCentricObject(this.x,this.y),game.drawType="camera"),this.cameraCooldownCurrent=this.cameraCooldown),"player"==game.drawType&&(draw.cameraX=this.x,draw.cameraY=this.y),"ship"==this.state&&(game.keys[game.KeyBinds.Ship.SHOOT]&&this.shotCooldownCurrent<=0&&this.shoot(this.shotType),this.velStrafe/=1.3,game.keys[game.KeyBinds.Ship.TURNLEFT]&&(this.orientation+=2),game.keys[game.KeyBinds.Ship.TURNRIGHT]&&(this.orientation-=2),game.keys[game.KeyBinds.Ship.ACCEL]&&(game.keys[game.KeyBinds.Ship.DECEL]||(this.velocity+=2*this.accel*a),this.velocity>2*this.moveSpeed&&(this.velocity=2*this.moveSpeed)),game.keys[game.KeyBinds.Ship.DECEL]&&(this.velocity+=-this.accel*a,this.velocity<2*-this.moveSpeed&&(this.velocity=2*-this.moveSpeed)),this.velocity<10&&(this.velocity+=this.accel*a),game.keys[game.KeyBinds.Ship.SPECIAL]||(this.heading=this.orientation)),"bot"==this.state&&(game.keys[game.KeyBinds.Bot.SHOOT]&&this.shotCooldownCurrent<=0&&this.shoot(this.shotType),game.keys[game.KeyBinds.Bot.STRAFELEFT]?(this.velStrafe+=20*-this.accel*a,this.velStrafe<-this.moveSpeed&&(this.velStrafe=-this.moveSpeed)):game.keys[game.KeyBinds.Bot.STRAFERIGHT]?(this.velStrafe+=20*this.accel*a,this.velStrafe>this.moveSpeed&&(this.velStrafe=this.moveSpeed)):this.velStrafe/=2,game.keys[game.KeyBinds.Bot.TURNLEFT]?this.orientation+=2:game.keys[game.KeyBinds.Bot.TURNRIGHT]&&(this.orientation-=2),game.keys[game.KeyBinds.Bot.ACCEL]?(this.velocity+=20*this.accel*a,this.velocity>this.moveSpeed&&(this.velocity=this.moveSpeed)):game.keys[game.KeyBinds.Bot.DECEL]?(this.velocity+=20*-this.accel*a,this.velocity<-this.moveSpeed&&(this.velocity=-this.moveSpeed)):this.velocity/=1.1,this.heading=this.orientation),this.updateState(a);var b=this.x,c=this.y;this.x+=this.velocity*Math.cos(toRad(this.heading))*a+this.velStrafe*Math.cos(toRad(this.heading-90))*a,this.y+=this.velocity*Math.sin(toRad(this.heading))*a+this.velStrafe*Math.sin(toRad(this.heading-90))*a;for(var d=0;d<game.currentSector.pillars.length;d++){var e=game.currentSector.pillars[d];pointInRectangle(this,e)&&("ship"==this.state?1==e.elevation&&(this.currentLife-=this.maxLife,this.isAlive=!1):"bot"==this.state&&(b<e.left()&&this.x>e.left()||b>e.right()&&this.x<e.right())&&(this.x=b),(c<e.bottom()&&this.y>e.bottom()||c>e.top()&&this.y<e.top())&&(this.y=c))}}},this.updateState=function(a){},this.shoot=function(a){if("SHOTGUN"==a)game.currentSector.bulletManager.addBullet(new bullet(this.x,this.y,this.orientation,100,.4,0,!0)),game.currentSector.bulletManager.addBullet(new bullet(this.x,this.y,this.orientation-3,100,.4,0,!0)),game.currentSector.bulletManager.addBullet(new bullet(this.x,this.y,this.orientation+3,100,.4,0,!0)),game.currentSector.bulletManager.addBullet(new bullet(this.x,this.y,this.orientation-7,100,.4,0,!0)),game.currentSector.bulletManager.addBullet(new bullet(this.x,this.y,this.orientation+7,100,.4,0,!0)),this.shotCooldownCurrent=2*this.shotCooldown;else if("MACHINEGUN"==a){var b=new bullet(this.x,this.y,this.orientation,100,1,1,!0);game.currentSector.bulletManager.addBullet(b),this.shotCooldownCurrent=this.shotCooldown/2}else"DEATH"==a&&(game.currentSector.bulletManager.addBullet(new bullet(this.x,this.y,this.orientation+45,100,.4,2,!0)),game.currentSector.bulletManager.addBullet(new bullet(this.x,this.y,this.orientation+90,100,.4,2,!0)),game.currentSector.bulletManager.addBullet(new bullet(this.x,this.y,this.orientation+135,100,.4,2,!0)),game.currentSector.bulletManager.addBullet(new bullet(this.x,this.y,this.orientation+180,100,.4,2,!0)),game.currentSector.bulletManager.addBullet(new bullet(this.x,this.y,this.orientation+225,100,.4,2,!0)))}}function rocket(){}function resizeGame(){var a=document.getElementById("gameArea"),b=4/3,c=window.innerWidth,d=window.innerHeight,e=c/d;e>b?(c=d*b,a.style.height=d+"px",a.style.width=c+"px"):(d=c/b,a.style.width=c+"px",a.style.height=d+"px"),a.style.marginTop=-d/2+"px",a.style.marginLeft=-c/2+"px";var f=document.getElementById("gameCanvas");f.width=c,f.height=d}function gameXToCanvasX(a){return a/game.gameWidth*gameCanvas.width}function gameYToCanvasY(a){return a/game.gameHeight*gameCanvas.height}function canvasXToGameX(a){return a*gameCanvas.width/game.gameWidth}function canvasYToGameY(a){return a*gameCanvas.height/game.gameHeight}function worldSector(a,b){this.pillars=[],this.bulletManager=new bulletManager,this.enemyManager=new enemyManager,this.update=function(a){for(var b=0;b<this.pillars.length;b++)this.pillars[b].update(a);this.bulletManager.update(a),this.enemyManager.update(a)},this.draw=function(){}}window.addEventListener("resize",resizeGame,!1),window.addEventListener("orientationchange",resizeGame,!1),window.addEventListener("keydown",keyDown,!1),window.addEventListener("keyup",keyUp,!1),window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){window.setTimeout(a,5)}}(),game=new gameObject,game.init(),draw=new drawCameraCentricObject,resizeGame(),animLoop();